class Item is
    var name : Integer(0)
    var weight : Integer(1)
    
    this(n: Integer, w: Integer) is
        name := n
        weight := w
    end
    
    method getName : Integer => name
    method getWeight : Integer => weight
    
    method describe : Integer => name.Mult(Integer(100)).Plus(weight)
end

class Weapon extends Item is
    var damage : Integer(10)
    
    this(n: Integer, w: Integer, d: Integer) is
        name := n
        weight := w
        damage := d
    end
    
    method getDamage : Integer => damage
    
    method describe : Integer => name.Mult(Integer(1000)).Plus(weight.Mult(Integer(10))).Plus(damage)
end

class Armor extends Item is
    var defense : Integer(5)
    
    this(n: Integer, w: Integer, def: Integer) is
        name := n
        weight := w
        defense := def
    end
    
    method getDefense : Integer => defense
    
    method describe : Integer => name.Mult(Integer(10000)).Plus(weight.Mult(Integer(100))).Plus(defense)
end

class Consumable extends Item is
    var healAmount : Integer(0)
    var quantity : Integer(1)
    
    this(n: Integer, w: Integer, heal: Integer, qty: Integer) is
        name := n
        weight := w
        healAmount := heal
        quantity := qty
    end
    
    method getHealAmount : Integer => healAmount
    method getQuantity : Integer => quantity
    
    method use : Integer is
        if quantity.Greater(Integer(0)) then
            quantity := quantity.Minus(Integer(1))
            return healAmount
        end
        return Integer(0)
    end
    
    method describe : Integer => name.Mult(Integer(100000)).Plus(healAmount.Mult(Integer(100))).Plus(quantity)
end

class Inventory is
    var items : List[Item]()
    var maxSize : Integer(10)
    var currentWeight : Integer(0)
    var maxWeight : Integer(100)
    
    this(maxSz: Integer, maxWt: Integer) is
        items := List[Item]()
        maxSize := maxSz
        maxWeight := maxWt
        currentWeight := Integer(0)
    end
    
    method addItem(item: Item) : Boolean is
        var newWeight : currentWeight.Plus(item.getWeight)
        if newWeight.Greater(maxWeight) then
            return false
        end
        if items.Length.GreaterEqual(maxSize) then
            return false
        end
        items.append(item)
        currentWeight := newWeight
        return true
    end
    
    method getCapacity : Integer => maxSize
    
    method canAddWeight(w: Integer) : Boolean is
        return currentWeight.Plus(w).LessEqual(maxWeight)
    end
    
    method getItem(index: Integer) : Item is
        return items.get(index)
    end
    
    method getSize : Integer => items.Length
    
    method getTotalWeight : Integer => currentWeight
    
    method getTotalValue : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(items.Length) loop
            total := total.Plus(items.get(i).describe)
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method printAll is
        var i : Integer(0)
        while i.Less(items.Length) loop
            print(items.get(i).describe)
            i := i.Plus(Integer(1))
        end
    end
end

class ArrayOperations is
    method sumArray(arr: Array[Integer]) : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(arr.Length) loop
            total := total.Plus(arr.get(i))
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method findMax(arr: Array[Integer]) : Integer is
        if arr.Length.Equal(Integer(0)) then
            return Integer(0)
        end
        var maxVal : arr.get(Integer(0))
        var i : Integer(1)
        while i.Less(arr.Length) loop
            if arr.get(i).Greater(maxVal) then
                maxVal := arr.get(i)
            end
            i := i.Plus(Integer(1))
        end
        return maxVal
    end
    
    method findMin(arr: Array[Integer]) : Integer is
        if arr.Length.Equal(Integer(0)) then
            return Integer(0)
        end
        var minVal : arr.get(Integer(0))
        var i : Integer(1)
        while i.Less(arr.Length) loop
            if arr.get(i).Less(minVal) then
                minVal := arr.get(i)
            end
            i := i.Plus(Integer(1))
        end
        return minVal
    end
    
    method reverseArray(arr: Array[Integer]) : Array[Integer] is
        var result : Array[Integer](arr.Length)
        var i : Integer(0)
        while i.Less(arr.Length) loop
            result.set(arr.Length.Minus(Integer(1)).Minus(i), arr.get(i))
            i := i.Plus(Integer(1))
        end
        return result
    end
    
    method countOccurrences(arr: Array[Integer], target: Integer) : Integer is
        var count : Integer(0)
        var i : Integer(0)
        while i.Less(arr.Length) loop
            if arr.get(i).Equal(target) then
                count := count.Plus(Integer(1))
            end
            i := i.Plus(Integer(1))
        end
        return count
    end
end

class ListOperations is
    method buildList(n: Integer) : List[Integer] is
        var result : List[Integer]()
        var i : Integer(0)
        while i.Less(n) loop
            result.append(i.Mult(Integer(2)))
            i := i.Plus(Integer(1))
        end
        return result
    end
    
    method sumList(lst: List[Integer]) : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(lst.Length) loop
            total := total.Plus(lst.get(i))
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method countElements(lst: List[Integer]) : Integer => lst.Length
    
    method getFirst(lst: List[Integer]) : Integer is
        return lst.head
    end
    
    method getRest(lst: List[Integer]) : List[Integer] is
        return lst.tail
    end
end

class PolymorphicCollectionTest is
    method fillWithDifferentItems(arr: Array[Item]) is
        arr.set(Integer(0), Item(Integer(1), Integer(5)))
        arr.set(Integer(1), Weapon(Integer(2), Integer(10), Integer(25)))
        arr.set(Integer(2), Armor(Integer(3), Integer(15), Integer(50)))
        arr.set(Integer(3), Consumable(Integer(4), Integer(2), Integer(100), Integer(3)))
    end
    
    method sumDescriptions(arr: Array[Item]) : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(arr.Length) loop
            total := total.Plus(arr.get(i).describe)
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method testPolymorphism : Integer is
        var items : Array[Item](4)
        this.fillWithDifferentItems(items)
        return this.sumDescriptions(items)
    end
end

class TestRunner is
    this() is
        print(Integer(111))
        
        var item1 : Item(Integer(10), Integer(5))
        print(item1.describe)
        
        var weapon1 : Weapon(Integer(5), Integer(8), Integer(30))
        print(weapon1.describe)
        print(weapon1.getDamage)
        
        var armor1 : Armor(Integer(7), Integer(20), Integer(75))
        print(armor1.describe)
        print(armor1.getDefense)
        
        var potion : Consumable(Integer(1), Integer(1), Integer(50), Integer(5))
        print(potion.describe)
        print(potion.use)
        print(potion.getQuantity)
        print(potion.use)
        print(potion.getQuantity)
        
        print(Integer(222))
        
        var inv : Inventory(Integer(5), Integer(50))
        print(inv.addItem(Item(Integer(1), Integer(10))))
        print(inv.addItem(Weapon(Integer(2), Integer(15), Integer(20))))
        print(inv.addItem(Armor(Integer(3), Integer(20), Integer(30))))
        print(inv.getSize)
        print(inv.getTotalWeight)
        print(inv.addItem(Item(Integer(4), Integer(20))))
        print(inv.getSize)
        print(inv.getTotalWeight)
        inv.printAll
        
        print(Integer(333))
        
        var arrOps : ArrayOperations()
        var testArr : Array[Integer](5)
        testArr.set(Integer(0), Integer(10))
        testArr.set(Integer(1), Integer(25))
        testArr.set(Integer(2), Integer(5))
        testArr.set(Integer(3), Integer(40))
        testArr.set(Integer(4), Integer(15))
        
        print(arrOps.sumArray(testArr))
        print(arrOps.findMax(testArr))
        print(arrOps.findMin(testArr))
        print(arrOps.countOccurrences(testArr, Integer(25)))
        print(arrOps.countOccurrences(testArr, Integer(99)))
        
        var reversed : arrOps.reverseArray(testArr)
        print(reversed.get(Integer(0)))
        print(reversed.get(Integer(1)))
        print(reversed.get(Integer(2)))
        print(reversed.get(Integer(3)))
        print(reversed.get(Integer(4)))
        
        print(Integer(444))
        
        var listOps : ListOperations()
        var myList : listOps.buildList(Integer(5))
        print(myList.Length)
        print(listOps.sumList(myList))
        print(listOps.getFirst(myList))
        
        var restList : listOps.getRest(myList)
        print(restList.Length)
        print(listOps.sumList(restList))
        
        print(Integer(555))
        
        var polyTest : PolymorphicCollectionTest()
        print(polyTest.testPolymorphism)
        
        print(Integer(666))
    end
end
