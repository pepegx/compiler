class MathHelper is
    method factorial(n: Integer) : Integer is
        var result : Integer(1)
        var i : Integer(1)
        while i.LessEqual(n) loop
            result := result.Mult(i)
            i := i.Plus(Integer(1))
        end
        return result
    end
    
    method fibonacci(n: Integer) : Integer is
        var a : Integer(0)
        var b : Integer(1)
        var temp : Integer(0)
        var i : Integer(0)
        while i.Less(n) loop
            temp := a.Plus(b)
            a := b
            b := temp
            i := i.Plus(Integer(1))
        end
        return a
    end
    
    method power(base: Integer, exp: Integer) : Integer is
        var result : Integer(1)
        var i : Integer(0)
        while i.Less(exp) loop
            result := result.Mult(base)
            i := i.Plus(Integer(1))
        end
        return result
    end
    
    method gcd(a: Integer, b: Integer) : Integer is
        var x : a
        var y : b
        var temp : Integer(0)
        while y.Greater(Integer(0)) loop
            temp := x.Rem(y)
            x := y
            y := temp
        end
        return x
    end
    
    method isPrime(n: Integer) : Boolean is
        if n.Less(Integer(2)) then
            return false
        end
        var i : Integer(2)
        while i.Mult(i).LessEqual(n) loop
            if n.Rem(i).Equal(Integer(0)) then
                return false
            end
            i := i.Plus(Integer(1))
        end
        return true
    end
end

class Matrix is
    var data : Array[Integer](9)
    var size : Integer(3)
    
    this() is
        data := Array[Integer](9)
        size := Integer(3)
        var i : Integer(0)
        while i.Less(Integer(9)) loop
            data.set(i, Integer(0))
            i := i.Plus(Integer(1))
        end
    end
    
    this(s: Integer) is
        size := s
        data := Array[Integer](s.Mult(s))
        var total : s.Mult(s)
        var i : Integer(0)
        while i.Less(total) loop
            data.set(i, Integer(0))
            i := i.Plus(Integer(1))
        end
    end
    
    method get(row: Integer, col: Integer) : Integer is
        var idx : row.Mult(size).Plus(col)
        return data.get(idx)
    end
    
    method set(row: Integer, col: Integer, val: Integer) is
        var idx : row.Mult(size).Plus(col)
        data.set(idx, val)
    end
    
    method fill(startVal: Integer) is
        var i : Integer(0)
        var val : startVal
        while i.Less(size) loop
            var j : Integer(0)
            while j.Less(size) loop
                this.set(i, j, val)
                val := val.Plus(Integer(1))
                j := j.Plus(Integer(1))
            end
            i := i.Plus(Integer(1))
        end
    end
    
    method sumAll : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(size) loop
            var j : Integer(0)
            while j.Less(size) loop
                total := total.Plus(this.get(i, j))
                j := j.Plus(Integer(1))
            end
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method sumDiagonal : Integer is
        var total : Integer(0)
        var i : Integer(0)
        while i.Less(size) loop
            total := total.Plus(this.get(i, i))
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method printMatrix is
        var i : Integer(0)
        while i.Less(size) loop
            var j : Integer(0)
            while j.Less(size) loop
                print(this.get(i, j))
                j := j.Plus(Integer(1))
            end
            i := i.Plus(Integer(1))
        end
    end
end

class Counter is
    var value : Integer(0)
    var step : Integer(1)
    var limit : Integer(100)
    
    this(s: Integer, l: Integer) is
        value := Integer(0)
        step := s
        limit := l
    end
    
    method increment : Integer is
        value := value.Plus(step)
        return value
    end
    
    method getValue : Integer => value
    
    method isAtLimit : Boolean => value.GreaterEqual(limit)
    
    method reset is
        value := Integer(0)
    end
    
    method countTo(target: Integer) : Integer is
        var iterations : Integer(0)
        while value.Less(target) loop
            value := value.Plus(step)
            iterations := iterations.Plus(Integer(1))
        end
        return iterations
    end
end

class NestedLoopTest is
    method sumRange(start: Integer, finish: Integer) : Integer is
        var total : Integer(0)
        var i : start
        while i.LessEqual(finish) loop
            total := total.Plus(i)
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method multiplyRange(start: Integer, finish: Integer) : Integer is
        var product : Integer(1)
        var i : start
        while i.LessEqual(finish) loop
            product := product.Mult(i)
            i := i.Plus(Integer(1))
        end
        return product
    end
    
    method countEven(n: Integer) : Integer is
        var count : Integer(0)
        var i : Integer(1)
        while i.LessEqual(n) loop
            if i.Rem(Integer(2)).Equal(Integer(0)) then
                count := count.Plus(Integer(1))
            end
            i := i.Plus(Integer(1))
        end
        return count
    end
    
    method sumOfSquares(n: Integer) : Integer is
        var total : Integer(0)
        var i : Integer(1)
        while i.LessEqual(n) loop
            total := total.Plus(i.Mult(i))
            i := i.Plus(Integer(1))
        end
        return total
    end
    
    method triangleNumber(n: Integer) : Integer is
        return n.Mult(n.Plus(Integer(1))).Div(Integer(2))
    end
end

class TestRunner is
    this() is
        var math : MathHelper()
        
        print(math.factorial(Integer(5)))
        print(math.factorial(Integer(7)))
        
        print(math.fibonacci(Integer(0)))
        print(math.fibonacci(Integer(1)))
        print(math.fibonacci(Integer(10)))
        
        print(math.power(Integer(2), Integer(10)))
        print(math.power(Integer(3), Integer(4)))
        
        print(math.gcd(Integer(48), Integer(18)))
        print(math.gcd(Integer(100), Integer(35)))
        
        print(math.isPrime(Integer(2)))
        print(math.isPrime(Integer(17)))
        print(math.isPrime(Integer(18)))
        print(math.isPrime(Integer(97)))
        
        var matrix : Matrix(Integer(3))
        matrix.fill(Integer(1))
        print(matrix.sumAll)
        print(matrix.sumDiagonal)
        matrix.printMatrix
        
        var counter : Counter(Integer(5), Integer(50))
        print(counter.getValue)
        print(counter.increment)
        print(counter.increment)
        print(counter.getValue)
        print(counter.isAtLimit)
        print(counter.countTo(Integer(45)))
        print(counter.getValue)
        print(counter.isAtLimit)
        
        var loops : NestedLoopTest()
        print(loops.sumRange(Integer(1), Integer(10)))
        print(loops.multiplyRange(Integer(1), Integer(5)))
        print(loops.countEven(Integer(20)))
        print(loops.sumOfSquares(Integer(5)))
        print(loops.triangleNumber(Integer(10)))
    end
end
